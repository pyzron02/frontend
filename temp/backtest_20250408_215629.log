21:56:30 - backtester - INFO - Logging system initialized with default level: INFO
21:56:30 - backtester - INFO - Log directory: /home/pyzron02/trading-strategy-backtester/logs
21:56:30 - backtester - INFO - Console output: True
21:56:30 - backtester - INFO - File output: True
21:56:30 - backtester - INFO - Async logging: True
21:56:30 - backtester - INFO - Async logging thread started
Registered strategy: SimpleStock (v1.0.1)
Registered strategy: MultiPosition (v1.0.1)
Registered strategy: AuctionMarket (v1.0.1)
Registered strategy: MACrossover (v1.0.0)
Starting backtest for strategy: MultiPosition
Tickers: ['TSLA', 'PLTR', 'NVDA']
Date range: 2020-01-01 to 2024-12-31
Output directory: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629
Registered strategy: SimpleStock (v1.0.1)
Registered strategy: MultiPosition (v1.0.1)
Registered strategy: AuctionMarket (v1.0.1)
Registered strategy: MACrossover (v1.0.0)
Found strategy class: MultiPositionStrategy
Running with fixed parameters
Parameters formatted for optimization: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/parameters.json
Running backtest | 21:56:32 - backtester - INFO - Set log level for all components to INFO
21:56:32 - backtester.workflow - INFO - Starting complete workflow for MultiPosition
21:56:32 - backtester.workflow - INFO - Tickers: ['TSLA', 'PLTR', 'NVDA']
21:56:32 - backtester.workflow - INFO - Period: 2020-01-01 to 2024-12-31
21:56:32 - backtester.workflow - INFO - Output directory: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629
21:56:32 - backtester.workflow - INFO - Parameter grid after normalization: {'max_positions': [5], 'position_size': [50], 'sma_period': [20]}
21:56:32 - backtester.workflow - WARNING - Could not copy parameter file: '/home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/parameters.json' and '/home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/parameters.json' are the same file
21:56:32 - backtester.workflow - INFO - In-sample period: 2020-01-01 to 2023-07-02
21:56:32 - backtester.workflow - INFO - Out-of-sample period: 2023-07-03 to 2024-12-31
21:56:32 - backtester.workflow - INFO - Starting in-sample optimization...
21:56:32 - backtester.workflow - INFO - Using 7 CPU cores for parallel optimization
Testing parameters:   0%|          | 0/1 [00:00<?, ?it/s]Testing parameters: 100%|██████████| 1/1 [00:00<00:00,  1.22it/s]Testing parameters: 100%|██████████| 1/1 [00:00<00:00,  1.19it/s]
21:56:33 - backtester.in_sample - INFO - Best parameters saved to /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/optimization/best_parameters.txt and /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/optimization/parameters.txt
21:56:33 - backtester.workflow - INFO - Optimization process output captured in /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/logs/optimization_output.log
21:56:33 - backtester.workflow - INFO - Best parameters found: {'max_positions': 5, 'position_size': 50, 'sma_period': 20}
21:56:33 - backtester.workflow - INFO - Copied parameters.txt from optimization directory to main output directory
21:56:33 - backtester.workflow - INFO - Starting walk-forward testing...
21:56:35 - backtester.workflow - INFO - Walk-forward process output captured in /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/logs/walkforward_output.log
21:56:35 - backtester.workflow - INFO - Walk-forward testing completed
21:56:35 - backtester.workflow - INFO - Starting Trade-Based Monte Carlo testing with 100 simulations using 7 workers...
21:56:35 - backtester.workflow - INFO - Date ranges: In-sample: 2020-01-01 to 2023-12-31, Out-of-sample: 2024-01-01 to 2024-12-31
21:56:35 - backtester.workflow - INFO - Using 7 CPU cores for Monte Carlo simulations
21:56:35 - backtester.workflow - INFO - Using Trade-Based Monte Carlo implementation
21:56:35 - backtester.workflow - INFO - Running 100 simulations with resampled trade returns
21:56:35 - backtester.workflow - INFO - Using 7 CPU cores for parallel processing
21:56:35 - backtester.workflow - INFO - Initialized Trade-Based Monte Carlo Test for MultiPosition strategy
21:56:35 - backtester.workflow - INFO - Parameters: {'max_positions': 5, 'position_size': 50, 'sma_period': 20}
21:56:35 - backtester.workflow - INFO - Tickers: ['TSLA', 'PLTR', 'NVDA']
21:56:35 - backtester.workflow - INFO - Number of simulations: 100
21:56:35 - backtester.workflow - INFO - Using 7 CPU cores for parallel processing
21:56:35 - backtester.workflow - INFO - Keep permuted data: True (This will save permuted data files)
21:56:35 - backtester.workflow - INFO - Permuted data will be saved in: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/monte_carlo/permuted_data
Creating permuted datasets:   0%|          | 0/100 [00:00<?, ?dataset/s]Creating permuted datasets:   2%|▏         | 2/100 [00:00<00:07, 13.55dataset/s]Creating permuted datasets:   4%|▍         | 4/100 [00:00<00:07, 12.74dataset/s]Creating permuted datasets:   6%|▌         | 6/100 [00:00<00:07, 12.78dataset/s]Creating permuted datasets:   8%|▊         | 8/100 [00:00<00:06, 13.45dataset/s]Creating permuted datasets:  10%|█         | 10/100 [00:00<00:06, 13.98dataset/s]Creating permuted datasets:  12%|█▏        | 12/100 [00:00<00:06, 14.39dataset/s]Creating permuted datasets:  14%|█▍        | 14/100 [00:01<00:05, 14.54dataset/s]Creating permuted datasets:  16%|█▌        | 16/100 [00:01<00:05, 14.17dataset/s]Creating permuted datasets:  18%|█▊        | 18/100 [00:01<00:06, 13.21dataset/s]Creating permuted datasets:  20%|██        | 20/100 [00:01<00:06, 12.38dataset/s]Creating permuted datasets:  22%|██▏       | 22/100 [00:01<00:05, 13.10dataset/s]Creating permuted datasets:  24%|██▍       | 24/100 [00:01<00:05, 13.55dataset/s]Creating permuted datasets:  26%|██▌       | 26/100 [00:01<00:05, 13.52dataset/s]Creating permuted datasets:  28%|██▊       | 28/100 [00:02<00:05, 13.74dataset/s]Creating permuted datasets:  30%|███       | 30/100 [00:02<00:04, 14.19dataset/s]Creating permuted datasets:  32%|███▏      | 32/100 [00:02<00:05, 13.40dataset/s]Creating permuted datasets:  34%|███▍      | 34/100 [00:02<00:05, 13.03dataset/s]Creating permuted datasets:  36%|███▌      | 36/100 [00:02<00:04, 13.54dataset/s]Creating permuted datasets:  38%|███▊      | 38/100 [00:02<00:04, 14.03dataset/s]Creating permuted datasets:  40%|████      | 40/100 [00:02<00:04, 14.23dataset/s]Creating permuted datasets:  42%|████▏     | 42/100 [00:03<00:04, 14.33dataset/s]Creating permuted datasets:  44%|████▍     | 44/100 [00:03<00:03, 14.68dataset/s]Creating permuted datasets:  46%|████▌     | 46/100 [00:03<00:03, 14.70dataset/s]Creating permuted datasets:  48%|████▊     | 48/100 [00:03<00:03, 14.43dataset/s]Creating permuted datasets:  50%|█████     | 50/100 [00:03<00:03, 13.25dataset/s]Creating permuted datasets:  52%|█████▏    | 52/100 [00:03<00:03, 13.03dataset/s]Creating permuted datasets:  54%|█████▍    | 54/100 [00:03<00:03, 13.21dataset/s]Creating permuted datasets:  56%|█████▌    | 56/100 [00:04<00:03, 13.66dataset/s]Creating permuted datasets:  58%|█████▊    | 58/100 [00:04<00:02, 14.02dataset/s]Creating permuted datasets:  60%|██████    | 60/100 [00:04<00:02, 13.35dataset/s]Creating permuted datasets:  62%|██████▏   | 62/100 [00:04<00:02, 13.13dataset/s]Creating permuted datasets:  64%|██████▍   | 64/100 [00:04<00:02, 13.48dataset/s]Creating permuted datasets:  66%|██████▌   | 66/100 [00:04<00:02, 13.81dataset/s]Creating permuted datasets:  68%|██████▊   | 68/100 [00:04<00:02, 13.95dataset/s]Creating permuted datasets:  70%|███████   | 70/100 [00:05<00:02, 13.25dataset/s]Creating permuted datasets:  72%|███████▏  | 72/100 [00:05<00:02, 13.66dataset/s]Creating permuted datasets:  74%|███████▍  | 74/100 [00:05<00:01, 14.08dataset/s]Creating permuted datasets:  76%|███████▌  | 76/100 [00:05<00:01, 14.27dataset/s]Creating permuted datasets:  78%|███████▊  | 78/100 [00:05<00:01, 13.87dataset/s]Creating permuted datasets:  80%|████████  | 80/100 [00:05<00:01, 12.36dataset/s]Creating permuted datasets:  82%|████████▏ | 82/100 [00:06<00:02,  6.90dataset/s]Creating permuted datasets:  84%|████████▍ | 84/100 [00:06<00:02,  7.67dataset/s]Creating permuted datasets:  86%|████████▌ | 86/100 [00:06<00:01,  8.15dataset/s]Creating permuted datasets:  88%|████████▊ | 88/100 [00:07<00:01,  8.97dataset/s]Creating permuted datasets:  90%|█████████ | 90/100 [00:07<00:01,  9.81dataset/s]Creating permuted datasets:  92%|█████████▏| 92/100 [00:07<00:00, 10.49dataset/s]Creating permuted datasets:  94%|█████████▍| 94/100 [00:07<00:00, 11.28dataset/s]Creating permuted datasets:  96%|█████████▌| 96/100 [00:07<00:00, 11.54dataset/s]Creating permuted datasets:  98%|█████████▊| 98/100 [00:07<00:00, 11.33dataset/s]Creating permuted datasets: 100%|██████████| 100/100 [00:08<00:00, 10.69dataset/s]Creating permuted datasets: 100%|██████████| 100/100 [00:08<00:00, 12.37dataset/s]
Running backtests:   0%|          | 0/100 [00:00<?, ?backtest/s]Running backtests:   1%|          | 1/100 [00:00<01:05,  1.51backtest/s]Running backtests:   8%|▊         | 8/100 [00:01<00:14,  6.50backtest/s]Running backtests:  15%|█▌        | 15/100 [00:01<00:08, 10.08backtest/s]Running backtests:  17%|█▋        | 17/100 [00:01<00:07, 10.93backtest/s]Running backtests:  22%|██▏       | 22/100 [00:02<00:07, 10.39backtest/s]Running backtests:  24%|██▍       | 24/100 [00:02<00:06, 11.34backtest/s]Running backtests:  27%|██▋       | 27/100 [00:02<00:05, 13.21backtest/s]Running backtests:  29%|██▉       | 29/100 [00:03<00:07,  9.49backtest/s]Running backtests:  33%|███▎      | 33/100 [00:03<00:05, 13.13backtest/s]Running backtests:  36%|███▌      | 36/100 [00:03<00:06,  9.82backtest/s]Running backtests:  41%|████      | 41/100 [00:03<00:04, 13.05backtest/s]Running backtests:  43%|████▎     | 43/100 [00:04<00:05,  9.90backtest/s]Running backtests:  45%|████▌     | 45/100 [00:04<00:05,  9.90backtest/s]Running backtests:  48%|████▊     | 48/100 [00:04<00:04, 12.44backtest/s]Running backtests:  50%|█████     | 50/100 [00:05<00:05,  8.88backtest/s]Running backtests:  52%|█████▏    | 52/100 [00:05<00:05,  9.29backtest/s]Running backtests:  56%|█████▌    | 56/100 [00:05<00:03, 11.32backtest/s]Running backtests:  58%|█████▊    | 58/100 [00:06<00:05,  7.09backtest/s]Running backtests:  60%|██████    | 60/100 [00:06<00:06,  5.73backtest/s]Running backtests:  63%|██████▎   | 63/100 [00:07<00:06,  5.49backtest/s]Running backtests:  65%|██████▌   | 65/100 [00:07<00:06,  5.79backtest/s]Running backtests:  69%|██████▉   | 69/100 [00:07<00:03,  7.91backtest/s]Running backtests:  71%|███████   | 71/100 [00:08<00:03,  7.73backtest/s]Running backtests:  73%|███████▎  | 73/100 [00:08<00:03,  8.72backtest/s]Running backtests:  75%|███████▌  | 75/100 [00:08<00:02,  9.83backtest/s]Running backtests:  77%|███████▋  | 77/100 [00:08<00:02,  8.82backtest/s]Running backtests:  79%|███████▉  | 79/100 [00:08<00:02,  8.56backtest/s]Running backtests:  81%|████████  | 81/100 [00:09<00:02,  9.32backtest/s]Running backtests:  83%|████████▎ | 83/100 [00:09<00:01,  9.00backtest/s]Running backtests:  85%|████████▌ | 85/100 [00:09<00:02,  6.34backtest/s]Running backtests:  87%|████████▋ | 87/100 [00:10<00:01,  6.82backtest/s]Running backtests:  90%|█████████ | 90/100 [00:10<00:01,  7.43backtest/s]Running backtests:  92%|█████████▏| 92/100 [00:10<00:01,  7.30backtest/s]Running backtests:  97%|█████████▋| 97/100 [00:10<00:00, 11.54backtest/s]Running backtests:  99%|█████████▉| 99/100 [00:11<00:00, 11.68backtest/s]Running backtests: 100%|██████████| 100/100 [00:11<00:00,  9.03backtest/s]
Processing results:   0%|          | 0/100 [00:00<?, ?simulation/s]Processing results:  29%|██▉       | 29/100 [00:00<00:00, 282.88simulation/s]Processing results:  59%|█████▉    | 59/100 [00:00<00:00, 289.64simulation/s]Processing results:  88%|████████▊ | 88/100 [00:00<00:00, 260.88simulation/s]Processing results: 100%|██████████| 100/100 [00:00<00:00, 271.38simulation/s]
21:57:04 - backtester.workflow - INFO - Trade logs summary saved to: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/monte_carlo/trade_log_summary.json
21:57:04 - backtester.workflow - INFO - Permuted price comparison plots saved to: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/monte_carlo/visualizations
21:57:04 - backtester.workflow - INFO - Monte Carlo metric: total_return - Original: 6.135014464218114, Mean: 12.831688295766561, p-value: 0.44
21:57:04 - backtester.workflow - INFO - Monte Carlo metric: sharpe_ratio - Original: 0.7014727126405789, Mean: 0.6882819095922169, p-value: 0.5
21:57:04 - backtester.workflow - INFO - Monte Carlo metric: max_drawdown - Original: 8.246291722392918, Mean: 9.278418392714913, p-value: 0.57
21:57:04 - backtester.workflow - INFO - Monte Carlo metric: win_rate - Original: 0.13559322033898305, Mean: 0.21587462299770974, p-value: 0.98
21:57:04 - backtester.workflow - INFO - Monte Carlo metric: profit_factor - Original: 1.6900268085311243, Mean: 1.7698001316120402, p-value: 0.33
21:57:04 - backtester.workflow - INFO - Monte Carlo process output captured in /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/logs/montecarlo_output.log
Starting unified workflow...
Using parameter file: /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/parameters.json
Parameter file exists. Contents:
{
    "parameters": {
        "max_positions": 5,
        "position_size": 50,
        "sma_period": 20
    }
}
Running backtest \ 21:57:04 - backtester.workflow - INFO - Complete workflow finished. Results saved to /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629
21:57:04 - backtester.workflow - INFO - 
Workflow completed successfully for MultiPosition
21:57:04 - backtester.workflow - INFO - Best parameters: {'max_positions': 5, 'position_size': 50, 'sma_period': 20}
21:57:04 - backtester.workflow - INFO - Results saved to /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629
Backtest completed!      
Backtest completed! Results saved to /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/complete_results.json

Summary:

Error running backtest: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback:
Traceback (most recent call last):
  File "/home/pyzron02/frontend/run_backtest.py", line 278, in main
    if not metrics_found or not ui_results['metrics']:
  File "/home/pyzron02/.local/lib/python3.10/site-packages/pandas/core/generic.py", line 1466, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().


Debugging information:
Python version: 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0]
Current directory: /home/pyzron02/frontend
PYTHONPATH: /home/pyzron02/trading-strategy-backtester:/home/pyzron02/trading-strategy-backtester/src
sys.path: ['/home/pyzron02/frontend', '/home/pyzron02/trading-strategy-backtester', '/home/pyzron02/trading-strategy-backtester/src', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/pyzron02/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages', '/home/pyzron02/trading-strategy-backtester', '/home/pyzron02/trading-strategy-backtester/src', '/home/pyzron02/trading-strategy-backtester/src/engine', '/home/pyzron02/trading-strategy-backtester', '/home/pyzron02/trading-strategy-backtester/src/runners', '/home/pyzron02/trading-strategy-backtester/src/strategies']
Error details saved to /home/pyzron02/trading-strategy-backtester/output/MultiPosition_20250408_215629/error.txt
